
{
  "api_key": "api_key",
  "api_url": "http://localhost/api/",
  "source_type_property_name": "INSPECTION_STANDARD",
  "source_type_id_whitelist": [
    # Right now everything goes to the same design,
    # but this might change depending on the outcome of the
    # NCC categories discussion.
    1001181, # "Enquiry Inspection RFS"
  ],
  "defect_inspection_parent_id": 1001181,
  "irg_config_code": "ASSET_INSPECTIONS",
  "attachment_folder_id": 52,

  "service_attribute_overrides": {
    # These are set in resource_attribute_defaults
    "1009856": { # Source
      "automated": "server_set",
      "required": 0,
    },

    # These attributes are set in request_to_resource_attribute_mapping
    "1009859": { # Summary
      "automated": "server_set",
      "required": 0,
    },
    "1009860": { # Explanation
      "automated": "server_set",
      "required": 0,
    },
    "1009855": { # Source ID
      "automated": "server_set",
      "required": 0,
    },
    "1010927": { # contact
      "automated": "server_set",
      "required": 0,
    },


  },

  # List of categories/subcategories and parent attribute id
  "service_whitelist": {
    "Bus Stops": {
      "Shelter Damaged": "1009853",
      "Sign/Pole Damaged": "1009853"
    },
    "Drains": {
      "Blocked - flooding private property": "1009847",
      "Blocked - flooding road/path": "1009847",
      "Blocked/Damaged": "1009847",
      "Blocked Ditch": "1009847",
      "Blocked Ditch Causing Flooding": "1009847",
    },
    "Highway Bridges": {
      "Highway Bridgers - Damaged/Unsafe": "1009815",
    },
    "Drain Covers": {
      "Loose / Raised/Sunken": "1009847",
      "Broken / Missing": "1009847",
    },
    "Footway/Footpath": {
      "Obstruction (Not Vegetation)": "1009847",
      "Pothole / Failed Reinstatement": "1009847",
      "Slabs - Uneven / Damaged / Cracked": "1009847",
      "Slabs - Missing": "1009847",
    },
    "Kerbs": {
      "Damaged/Loose": "1009847",
      "Missing": "1009847",
    },
    "Crash Barriers": {
      "Crash Barriers - Damaged / Missing": "1009847",
    },
    "Pedestrian Barriers": {
      "Pedestrian Barriers - Damaged / Missing": "1009836",
    },
    "Rights of Way": {
      "Bridge-Damaged/ Missing": "1009848",
      "Gate - Damaged/ Missing": "1009829",
      "Livestock": "1009835",
      "Passage-Obstructed/Overgrown": "1009835",
      "Sign/Waymarking - Damaged/Missing": "1009814",
      "Stile-Damaged/Missing": "1009825",
    },
    "Road Markings": {
      "Road Markings - Worn/Faded": "1009847",
    },
    "Roads": {
      "Damaged Speed Humps": "1009824",
      "Flooding": "1009847",
      "Mud on Road": "1009847",
      "Potholes / Highway Condition": "1009847",
      "Spill - Oil/Diesel": "1009847",
    },
    "Safety Bollard": {
      "Safety Bollard - Damaged/Missing": "1009847",
    },
    "Sign": {
        "Damaged / Missing / Facing Wrong Way": "1009816",
        "Obscured by vegetation or Dirty": "1009816",
    },
    "Traffic Signals / Crossings": {
      "Damaged/Exposed Wiring / Vandalised": "1009847",
      "Lamp/Bulb Failure": "1009847",
      "Signal Failure": "1009847",
      "Signal Failure all out": "1009847",
      "Signal Stuck": "1009847",
      "Signal Head Failure": "1009847",
      "Request Timing Review": "1009847",
      "Damaged Control box": "1009847",
      "Signal Failure/Damaged - Toucan/Pelican": "1009847",
    },
    "Vegetation": {
      "Fallen Tree": "1009822",
      "Restricted Visibility / Overgrown / Overhanging": "1009822",
      "Restricted Visibility": "1009822",
      "Weeds": "1009847",
    },
    "Verges": {
      "Verges - Damaged by Vehicles": "1009847",
    },
    "Winter Maintenance": {
        "Grit Bin - damaged/replacement": "1009831",
        "Grit Bin - empty/refill": "1009831",
        "Icy Footpath": "1009847",
        "Icy Road": "1009847",
        "Missed published Gritted Route": "1009847",
    },
  },

  # Some resource attributes always have the same values when sent to Alloy
  "resource_attribute_defaults": {
    # This sets "PROJECT_TASK_STATUS" to "Proposed"
    "1001546": [
      {
        "command": "add",
        "resourceId": 1
      }
    ],

    # Sets "TEAM" to "Highways"
    "1001825": [
      {
        "command": "add",
        "resourceId": 708823
      }
    ],

    # Source
    "1009856": "FixMyStreet",

    # Enquiry type
    "1009857": "Request for Service",
  },

  # open311-adapter asks FMS for the problem title and description
  # in attributes as defined in O::E::Service::UKCouncil::Alloy,
  # which should be sent to Alloy in specific attribute fields
  # in the resource. Rather than let the FMS cobrand's open311_config
  # method put these values in the attributes, which would require
  # FMS to know about specific Alloy attribute IDs, handle this mapping
  # on this end.
  # NB: This will override any resource_attribute_defaults if present.
  # TODO: These currently apply to all source types/designs.
  "request_to_resource_attribute_mapping": {
    "title": 1009859, # summary
    "description": 1009860, # explanation
    "fixmystreet_id": 1009855, # Source ID
    "category": 1009858, # category
  },

  # When a new inspection resource is POSTed to Alloy, we use
  # one of the attributes of the returned JSON object as the external
  # ID on FMS. This config key indicates which one to use.
  # This is Northamptonshire specific right now
  # (see E::I::UK:Northamptonshire::service_request_id_for_resource)
  "inspection_id_attribute": "1003787",

  # There are some Alloy resource attributes which we never want to include
  # in our Open311 services - they may be irrelevant, or have values
  # calculated at the time the resource is POSTed to Alloy.
  # List these Alloy attribute IDs here.
  "ignored_attributes": [
    1009861, # Reported DateTime - current time is used
  ],


  # Alloy doesn't seem to natively have a way to indicate the time
  # that a resource was created, and instead stores the report datetime
  # in a resource attribute. This attribute varies by council, so
  # specify it here so the code can fill it in when creating a new
  # resource. This timestamp is in ISO 8601 format, hooray.
  "created_datetime_attribute_id": 1009861,


  # map attributes from inspections/defects back to update values
  "inspection_attribute_mapping": {
      "description": 1000594,
      "status": 1001546, # this is a structure so needs more processing
      "reason_for_closure": 1010926,
      "inspector_comments": 1011096,
  },

  "inspection_status_mapping": {
    "1": "open", # proposed
    "2": "investigating", # issued to contractor
    "4": "investigating", # in progress
    # "3": "" # on hold
    "6": "closed" # closed
    # "8": "" # cancelled
  },

  "inspection_closure_mapping": {
    4281523: 'in_progress', # works instructed
    4281524: 'no_further_action', # no action necessary
    4281525: 'not_councils_responsibility', # outside NCC control
    4281526: 'no_further_action', # highways to monitor
  },

  "inspection_resource_name": "INSPECTION_STANDARD INSPECTION_STANDARD",

  "defect_sourcetype_category_mapping": {
		1000793: '',
		1000792: '',
		1000795: '',
		1000794: '',
		1000941: '',
		1000942: 'Highway Bridges - Damaged/Unsafe',
		1000948: '',
		1000796: '',
		1000945: '',
		1000800: '',
		1000801: '',
		1000797: '',
		1000802: '',
		1000749: '',
		1001025: '',
		1000803: '',
		1000804: '',
		1000943: '',
		1000806: '',
		1001018: '',
		1000807: '',
		1000805: '',
		1001022: '',
		1001019: '',
		1000808: '',
		1000811: '',
		1000809: 'Grin Bin - damaged/replacement',
		1000810: '',
		1000812: '',
		1000944: '',
		1000951: '',
		1000658: '',
		1000813: '',
		1000814: '',
		1000815: '',
		1001023: '',
		1000816: '',
		1000817: '',
		1000946: '',
		1001061: '',
		1000818: 'Road Markings - Worn/Faded',
		1000819: '',
		1000821: '',
		1000822: 'Damaged / Missing / Facing Wrong Way',
		1001026: '',
		1001027: '',
		1001028: 'Stile-Damaged/Missing',
		1000947: '',
		1000820: '',
		1001057: 'Damaged Speed Humps',
		1000823: '',
		1000949: 'Fallen Tree',
		1001035: 'Sign/Waymarking - Damaged/Missing',
  },

  "defect_status_mapping": {
    "1001022": "open", #     "Reported"
    "1001023": "investigating", # "Waiting For Inspection"
    "1001024": "investigating", # "Confirmed"
    "1001025": "action_scheduled", # "Order Raised"
    "1001026": "fixed", # "Remedied"
    #"1001027": "" # "Found and Forwarded"
    #"1002682": "" # "Rejected"
  },

  "defect_resource_name": "DEFECT_STANDARD DEFECT_STANDARD",

  "defect_attribute_mapping": {
      "description": 1000594,
      "status": 1000604,
      "created": 1000603,
      "number": 1003788, # this is the DEF-NNN and not resourceId
      "fixmystreet_id": 1009999,
  },

  "contact": {
      "attribute_id": "1010927",
      "source_id": "2644",
      "search_entity_code": "USER_ST USER_ST_FMS_CONTACTS",
      "search_attribute_code": "STU_USER_ST_FMS_CONTACTS_ATT_EMAIL",
      "acceptance_datetime_attribute": "",
      "attribute_defaults": {
          "1011047": "1" # GDPR consent
      },
      "attribute_mapping": {
          "first_name": "1011044",
          "last_name": "1011045",
          "email": "1011046",
          "phone_number": "1011051"
      },
  }
}
